<!DOCTYPE html>
<html lang="en">
<%- include('partials/header') %>
<link rel="stylesheet" href="/css/drive.css">
<script src="/scripts/modals.js"></script>
<body>
    <%- include('partials/nav') %>
    <%- include('partials/alerts.ejs') %>
    <div class="container asidePage">
        <%- include('partials/sidebar', { dirObjs: folders, currId: itemId }) %>
        <div class="asideMain">
            <div class="container">
                <div class="mainView">
                    <div class="fPathList">
                        <b>./</b>
                        <% filePath.forEach((path, index) => {  %>
                            <span class="fPathItem">
                                <a href="<%= `${locals.baseUrl}/${path.id}` %>">
                                   <%= path.name %>
                                </a>
                            </span> 
                            <%= index !== filePath.length - 1 ? '>' : '' %>
                        <% }) %>
                    </div>
                    <div class="fContent">
                        <div class="fContentHeader">
                            <div>Name</div>
                            <div>Type</div>
                            <div>Size</div>
                            <div>Created</div>
                        </div>
                        <div class="fContentRows">
                            <% if (folderContent.length===0) { %>
                                <div class="emptyContent">
                                    No files or folders to display
                                </div>
                            <% } else { %>
                                <% folderContent.forEach((item) => {  %>
                                    <div class="fContentRowItem">
                                        <div class="contentName">
                                            <a class="contentNameLink" href="<%= `${locals.baseUrl}/${item.id}` %>">
                                                <span class="crIcon material-symbols-rounded">
                                                    <%= item.type==='FOLDER' ? 'create_new_folder' : 'image' %>
                                                </span>
                                                <span class="crName">
                                                    <%= item.name %>
                                                </span>
                                            </a>
                                            <div class="contentNameActions">
                                                <% if (item.type==='FILE') { %>
                                                    <a href="">
                                                        <span class="material-symbols-rounded">share</span>
                                                    </a>
                                                    <a href="">
                                                        <span class="material-symbols-rounded">download</span>
                                                    </a>
                                                <% } %>
                                                <a href="<%= `${locals.baseUrl}/${item.id}/delete` %>">
                                                    <span class="material-symbols-rounded">delete_forever</span>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="contentType">
                                            <%= item.mimeType ? item.mimeType : '--' %>
                                        </div>
                                        <div class="contentSize">
                                            <%= item.type==='FOLDER' ? '--' : item.fileSize %>
                                        </div>
                                        <div class="contentDate">
                                            <%= dateFmtr(item.createdAt) %>
                                        </div>
                                    </div>
                            <% })} %>
                        </div>
                    </div>
                </div>
            </div>


            <div class="modal" id="folderModal">
                <div class="modalContent">
                    <div class="modalHeader">
                        <h3>Create New Folder</h3>
                        <button id="closeFolderModal">&times;</button>
                    </div>
                    <form action="/drive/create<%= itemId ? '?itemId=' + itemId : '' %>" method="POST" class="modalForm">
                        <div class="modalEntry">
                            <label for="createFolder">''</label>
                            <input id="createFolder" name="createFolder" maxlength="10" placeholder="Enter Name (10 chars)" type="text" required>
                        </div>
                        <div class="modalSubmit">
                            <button>Create Folder</button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="modal" id="fileModal">
                <div class="modalContent">
                    <div class="modalHeader">
                        <h3>Upload File</h3>
                        <button id="closeFileModal">&times;</button>
                    </div>
                    <form action="/drive/upload<%= itemId ? '?itemId=' + itemId : '' %>" method="POST" class="modalForm" enctype="multipart/form-data">
                        <div class="modalEntry">
                            <label for="upldFile"></label>
                            <input id="upldFile" name="upldFile" type="file">
                        </div>
                        <div class="modalSubmit">
                            <button>Upload</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </div>
    
</body>
</html>